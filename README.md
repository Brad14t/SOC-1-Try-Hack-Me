# THM-Wazuh & Monday Monitor
THM Wazuh

**1. When was Wazuh released?)**

<img width="881" height="54" alt="Screenshot 2025-09-19 213354" src="https://github.com/user-attachments/assets/6a8f5e81-6737-4c85-9bfa-0658205924c9" />

**2. What is the term that Wazuh calls a device that is being monitored for suspicious activity and potential security threats?**

<img width="824" height="755" alt="Screenshot 2025-09-19 213447" src="https://github.com/user-attachments/assets/ad8345b8-c3f2-41a9-b525-b38a4668269e" />

**3. Lastly, what is the term for a device that is responsible for managing these devices?**

`Manager`

**4. How many agents does this Wazuh management server manage?**

<img width="817" height="456" alt="Screenshot 2025-09-23 123303" src="https://github.com/user-attachments/assets/11bf3229-3afd-4c68-b436-5e1fa6f22f08" />

**5. What are the status of the agents managed by this Wazuh management server?**

I can see from last answer its disconnected.

**6. How many "Security Event" alerts have been generated by the agent "AGENT-001"? Note: You will need to make sure that your time range includes the 11th of March 2022**

First I go to the dashboard for security events, and set the time to a long time ago, and see the answer there.

![1](https://github.com/user-attachments/assets/7814a7f9-1a6a-425a-a720-c68bb91ea31c)

![2](https://github.com/user-attachments/assets/d83f52b6-5958-493c-bef3-bc56f5a9a6c8)

**7. What is the name of the tool that we can use to monitor system events?**

`sysmon` I can see from the manay examples they provided.

**8. What standard application on Windows do these system events get recorded to?**

`event viewer` I found this by thinking back to the THM Sysmon modules.

**9. What is the full file path to the rules located on a Wazuh management server?**

<img width="744" height="138" alt="Screenshot 2025-09-23 125005" src="https://github.com/user-attachments/assets/9a49f15f-516f-4fd8-a6f3-afacf1660e32" />

**10. What application do we use on Linux to monitor events such as command execution?**

`auditd` 

<img width="718" height="204" alt="Screenshot 2025-09-23 125250" src="https://github.com/user-attachments/assets/e3a63b6d-c542-48b1-852b-e1615b4ad33e" />

**11. What is the full path & filename for where the aforementioned application stores rules?**

<img width="718" height="150" alt="Screenshot 2025-09-23 125437" src="https://github.com/user-attachments/assets/5f78947c-2d63-425c-8082-823583b9b2c9" />

**12. What is the name of the standard Linux tool that we can use to make requests to  the Wazuh management server?**

`curl`

<img width="705" height="175" alt="Screenshot 2025-09-23 125722" src="https://github.com/user-attachments/assets/da2d41a7-b4e6-43a5-8494-2eafd4e26583" />

**13. What HTTP method would we use to retrieve information for a Wazuh management server API?**

`GET` this should be known.

**14. What HTTP method would we use to perform an action on a Wazuh management server API?**

<img width="726" height="107" alt="Screenshot 2025-09-23 125950" src="https://github.com/user-attachments/assets/51fc89fe-23e1-494b-a6f5-31d9b310d734" />

**15. Use the API console to find the Wazuh server's version. Note: You will need to add the "v" prefix to the number for this answer. For example v1.2.3**

After going to the API console, run the command `GET / manager / info` command on line 9.

<img width="533" height="270" alt="Screenshot 2025-09-23 130153" src="https://github.com/user-attachments/assets/9db3ead6-5c4c-4e69-ae46-50404339cd4f" />

<img width="761" height="443" alt="Screenshot 2025-09-23 130441" src="https://github.com/user-attachments/assets/5a476c06-509e-4f0a-bc3b-58ec5f299b5e" />

# Monday Monitor

**1. Initial access was established using a downloaded file. What is the file name saved on the host?**

First I went to `Policy Monitor` then selected `Events`

<img width="1046" height="630" alt="Screenshot 2025-09-23 141905" src="https://github.com/user-attachments/assets/cfad9136-7f0e-4adf-808e-8b8f642e6c01" />

Then set the time to `April 29th 2024`

<img width="957" height="433" alt="Screenshot 2025-09-23 142256" src="https://github.com/user-attachments/assets/f8d38294-3594-4d92-9e9f-0c6ea87ee9d2" />

Then I started going through some entries, I noticed the `data.win.eventdata.commandLine` field had all the important info regarding commands and files. I added it to my columns, then started scrolling through to see if anything styck out to me. 

I eventually found one with a powershell command, not knowing what it is, I looked it up and found it is a command to download a remote file from a server, save it to a local temp folder with a different name.

<img width="783" height="339" alt="Screenshot 2025-09-23 143015" src="https://github.com/user-attachments/assets/426730c5-50cb-4381-92d5-f071bd0dc23e" />

As I can see the url is what the answer is. `SwiftSpend_Financial_Expenses.xlsm`

**2. What is the full command run to create a scheduled task?**

Scrolling through the entries and I see a macro started, I investigated into it and went down a couple more entires, made sure the parent command line pointed to that last macro enabled entrie. And the answer was there. The macro is creating a schedualed task, and the parent command line confirms thay are connected.

`\”cmd.exe\” /c \”reg add HKCU\\SOFTWARE\\ATOMIC-T1053.005 /v test /t REG_SZ /d cGluZyB3d3cueW91YXJldnVsbmVyYWJsZS50aG0= /f &amp; schtasks.exe /Create /F /TN \”ATOMIC-T1053.005\” /TR \”cmd /c start /min \\\”\\\” powershell.exe -Command IEX([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String((Get-ItemProperty -Path HKCU:\\\\SOFTWARE\\\\ATOMIC-T1053.005).test)))\” /sc daily /st 12:34\”`

<img width="1568" height="226" alt="Screenshot 2025-09-23 144052" src="https://github.com/user-attachments/assets/1836588c-4c31-46dd-92eb-43973cef2c41" />

<img width="1525" height="505" alt="Screenshot 2025-09-23 144107" src="https://github.com/user-attachments/assets/880eebf3-2ef8-4334-8c1b-a12563a37588" />

<img width="1357" height="230" alt="Screenshot 2025-09-23 144114" src="https://github.com/user-attachments/assets/9a96d480-fe9e-4ee7-aa9d-b521ecd22597" />

**3. What time is the scheduled task meant to run?**

We can see the answer in the last answer, `/st 12:34\` this makes the task run at 12:34

**4. What was encoded?**

From that `\”cmd.exe\”` entry if you look within the command you can see a Base-64 encoded string. Put that into cyber chef. Encoded `cGluZyB3d3cueW91YXJldnVsbmVyYWJsZS50aG0`

<img width="1153" height="658" alt="Screenshot 2025-09-23 144616" src="https://github.com/user-attachments/assets/2662c0c9-3e01-4195-9f60-995f79e6e5a9" />

**5. What password was set for the new user account?**

I started scrolling through the entries, and notices a localgroup entry, scolled down a couple and found the name of the user created as `guest`

<img width="789" height="387" alt="Screenshot 2025-09-23 150215" src="https://github.com/user-attachments/assets/df19e1bb-f43e-4b02-a0e6-4e191d949868" />

Scrolled down a couple more and I can see account guest with password `I_AM_M0NIT0R1NG`

<img width="1143" height="78" alt="Screenshot 2025-09-23 150740" src="https://github.com/user-attachments/assets/99691a13-b769-46fd-b2b7-332183133459" />

**6. What is the name of the .exe that was used to dump credentials?**

Scrolling down a few entries from the last answer, I found this one and it gave the name of the exe that was used to dumpcredentials.

<img width="1546" height="373" alt="Screenshot 2025-09-23 150911" src="https://github.com/user-attachments/assets/5b2288e1-ff68-4d9c-862f-0f36810f425c" />

**7. Data was exfiltrated from the host. What was the flag that was part of the data?**

Scrolling through entries I cam across this one that kinda gave it away because I could recognize the flag.

<img width="1537" height="213" alt="Screenshot 2025-09-23 151205" src="https://github.com/user-attachments/assets/29fa0100-f190-49cf-b999-c773e0a3e500" />

<img width="956" height="435" alt="Screenshot 2025-09-23 151249" src="https://github.com/user-attachments/assets/5e1c47d2-5570-41f1-94db-b34c44a74b23" />




































